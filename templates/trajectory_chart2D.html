{% extends 'base.html' %}
{% load static %}
{% block extra_head %}
{% block title %}2D Survey{% endblock %}
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
$(document).ready(function(){
    var demostrativo = {{ demostrativo|lower }};

    var xData = [
    0, 452, 904, 1356, 1808, 2260, 2712, 3164, 3616, 4068, 4520, 4972,
    5424, 5876, 6328, 6780, 7232, 7684, 8136, 8661, 9040
]

    var yData = [
    0.6998, 0.5417, 0.4712, 0.4340, 0.4135, 0.4027, 0.3979, 0.3971,
    0.3993, 0.4036, 0.4094, 0.4165, 0.4246, 0.4335, 0.4430, 0.4530,
    0.4635, 0.4743, 0.4855, 0.5353, 0.5086
];






    if (demostrativo) {
        for (var i = 0; i < xData.length; i++) {
            var newRow = `<tr>
                <td><input type="text" name="x[]" value="${xData[i]}" required></td>
                <td><input type="text" name="y[]" value="${yData[i]}" required></td>
                <td><button type="button" class="remove-row btn btn-danger">Eliminar</button></td>
            </tr>`;
            $("#data-table tbody").append(newRow);
        }
    }

    $("#add-row").click(function(){
        var newRow = `<tr>
            <td><input type="text" name="x[]" required></td>
            <td><input type="text" name="y[]" required></td>
            <td><button type="button" class="remove-row btn btn-danger">Eliminar</button></td>
        </tr>`;
        $("#data-table tbody").append(newRow);
    });

    $(document).on('click', '.remove-row', function(){
        $(this).closest('tr').remove();
    });

    $("#data-form").submit(function(event){
        event.preventDefault();
        var data = $(this).serialize();
        $.post("{% url 'trajectory_chart2D' %}", data, function(response){
            $("#plot-div-3d").html(response.plot_div_3d);
        });
    });
});
</script>
<style>
    body {
        background-color: rgb(245, 245, 245);
    }
    .principalContainer {
        max-height: 100vh;
        border: 1px solid black;
    }
    .principalDataContainer {
        max-height: 95vh;
        overflow-y: scroll;
        border-right: 1px solid black;
    }
    .cabeceraTable {
        border-top: 1px solid black;
    }
    .titleTable {
        padding-top: 7px;
    }
</style>
{% endblock %}

{% block content %}
<div class="row principalContainer">
    <div class="col-6 principalDataContainer">
        <h3 class="titleTable">Tabla de Datos</h3>
        <form id="data-form" method="post">
            {% csrf_token %}
            <button class="btn btn-primary mt-1 mb-1" type="submit">Enviar datos</button>
            <a href="/" class="btn btn-warning mt-1 mb-1 ml-5" type="submit">Cambiar a gr치fico 3D</a>
            <table class="table table-striped" id="data-table" border="1">
                <thead>
                    <tr class="position-relative cabeceraTable">
                        <th>Profundidad (ft)</th>
                        <th>IS (ft)</th>
                        <th>Acci칩n</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><input type="text" name="x[]" required></td>
                        <td><input type="text" name="y[]" required></td>
                        <td><button type="button" class="remove-row btn btn-danger">Eliminar</button></td>
                    </tr>
                </tbody>
            </table>
            <button class="btn btn-info mb-2" type="button" id="add-row">A침adir fila</button>
        </form>
    </div>
    
    <div class="col-6">
        <h3>Gr치fico 2D Survey</h3>
        <div class="w-100 p-0" id="plot-div-3d">{{ plot_div_3d|safe }}</div>
    </div>
</div>




{% endblock %}
